{"ast":null,"code":"var _jsxFileName = \"/opt/demo/secure-js-api-jwt/src/components/AddBook.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { Grid, Typography, Button, TextField, Snackbar } from \"@material-ui/core\";\nimport \"../styles.css\";\nimport { AppHeader } from \"./AppHeader\";\nimport { useHistory } from \"react-router-dom\";\nimport { constructHeader, isMember, updateAppSettings } from \"../util\";\nconst url = \"http://localhost:5000/book\";\nexport const AddBook = () => {\n  const [book, setBookName] = useState(\"\");\n  const [author, setAuthorName] = useState(\"\");\n  const [open, setOpen] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const history = useHistory();\n  const showPage = !isMember();\n  useEffect(() => {\n    if (!localStorage.getItem(\"token\")) history.push(\"/login\"); // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const onChangeBookName = book => setBookName(book);\n\n  const onChangeAuthorName = author => setAuthorName(author);\n\n  const redirect = () => {\n    localStorage.clear();\n    history.push(\"/login\");\n  };\n\n  const clearTextFields = () => {\n    setBookName(\"\");\n    setAuthorName(\"\");\n  };\n\n  const onClick = () => {\n    const bookData = {\n      name: book,\n      author: author\n    };\n    fetch(url, {\n      headers: constructHeader(\"application/json\"),\n      method: \"POST\",\n      body: JSON.stringify(bookData)\n    }).then(res => {\n      if (res.status === 401) redirect();else {\n        setOpen(true);\n        if (res.status === 200) clearTextFields();\n      }\n      return res.json();\n    }).then(json => {\n      if (json) {\n        updateAppSettings(json.token || \"\");\n        setMessage(json.message || \"\");\n      }\n    }).catch(err => console.log(\"Error adding book \", err.message));\n  };\n\n  const handleClose = () => setOpen(false);\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"AddBook\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(AppHeader, {\n    tabValue: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 7\n    }\n  }), !showPage && /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 21\n    }\n  }), showPage && /*#__PURE__*/React.createElement(Grid, {\n    container: true,\n    direction: \"column\",\n    alignItems: \"center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    style: {\n      marginBottom: \"5vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    variant: \"h3\",\n    gutterBottom: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 11\n    }\n  }, \"Add New Book!\", /*#__PURE__*/React.createElement(\"span\", {\n    role: \"img\",\n    \"aria-label\": \"books\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }\n  }, \"\\uD83D\\uDCD8\"))), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    style: {\n      marginBottom: \"5vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    id: \"bookname-input\",\n    variant: \"outlined\",\n    label: \"book\",\n    value: book,\n    onChange: e => onChangeBookName(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    style: {\n      marginBottom: \"5vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    id: \"authorname-input\",\n    variant: \"outlined\",\n    label: \"author\",\n    value: author,\n    onChange: e => onChangeAuthorName(e.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Grid, {\n    item: true,\n    style: {\n      marginBottom: \"7vh\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    \"aria-label\": \"login\",\n    variant: \"contained\",\n    size: \"large\",\n    color: \"primary\",\n    onClick: onClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102,\n      columnNumber: 11\n    }\n  }, \"ADD BOOK\")), /*#__PURE__*/React.createElement(Grid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Snackbar, {\n    open: open,\n    message: message,\n    autoHideDuration: 2000,\n    onClose: handleClose,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113,\n      columnNumber: 11\n    }\n  }))));\n};","map":{"version":3,"sources":["/opt/demo/secure-js-api-jwt/src/components/AddBook.js"],"names":["React","useState","useEffect","Grid","Typography","Button","TextField","Snackbar","AppHeader","useHistory","constructHeader","isMember","updateAppSettings","url","AddBook","book","setBookName","author","setAuthorName","open","setOpen","message","setMessage","history","showPage","localStorage","getItem","push","onChangeBookName","onChangeAuthorName","redirect","clear","clearTextFields","onClick","bookData","name","fetch","headers","method","body","JSON","stringify","then","res","status","json","token","catch","err","console","log","handleClose","marginBottom","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport {\n  Grid,\n  Typography,\n  Button,\n  TextField,\n  Snackbar,\n} from \"@material-ui/core\";\nimport \"../styles.css\";\nimport { AppHeader } from \"./AppHeader\";\nimport { useHistory } from \"react-router-dom\";\nimport { constructHeader, isMember, updateAppSettings } from \"../util\";\n\nconst url = \"http://localhost:5000/book\";\n\nexport const AddBook = () => {\n  const [book, setBookName] = useState(\"\");\n  const [author, setAuthorName] = useState(\"\");\n  const [open, setOpen] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const history = useHistory();\n  const showPage = !isMember();\n\n  useEffect(() => {\n    if (!localStorage.getItem(\"token\")) history.push(\"/login\");\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const onChangeBookName = (book) => setBookName(book);\n\n  const onChangeAuthorName = (author) => setAuthorName(author);\n\n  const redirect = () => {\n    localStorage.clear();\n    history.push(\"/login\");\n  };\n\n  const clearTextFields = () => {\n    setBookName(\"\");\n    setAuthorName(\"\");\n  };\n\n  const onClick = () => {\n    const bookData = { name: book, author: author };\n    fetch(url, {\n      headers: constructHeader(\"application/json\"),\n      method: \"POST\",\n      body: JSON.stringify(bookData),\n    })\n      .then((res) => {\n        if (res.status === 401) redirect();\n        else {\n          setOpen(true);\n          if (res.status === 200) clearTextFields();\n        }\n        return res.json();\n      })\n      .then((json) => {\n        if (json) {\n          updateAppSettings(json.token || \"\");\n          setMessage(json.message || \"\");\n        }\n      })\n      .catch((err) => console.log(\"Error adding book \", err.message));\n  };\n\n  const handleClose = () => setOpen(false);\n\n  return (\n    <div className=\"AddBook\">\n      <AppHeader tabValue={2} />\n      {!showPage && <div />}\n      {showPage && (\n      <Grid container direction=\"column\" alignItems=\"center\">\n        <Grid item style={{ marginBottom: \"5vh\" }}>\n          <Typography variant=\"h3\" gutterBottom>\n            Add New Book!\n            <span role=\"img\" aria-label=\"books\">\n              📘\n            </span>\n          </Typography>\n        </Grid>\n        <Grid item style={{ marginBottom: \"5vh\" }}>\n          <TextField\n            id=\"bookname-input\"\n            variant=\"outlined\"\n            label=\"book\"\n            value={book}\n            onChange={(e) => onChangeBookName(e.target.value)}\n          />\n        </Grid>\n        <Grid item style={{ marginBottom: \"5vh\" }}>\n          <TextField\n            id=\"authorname-input\"\n            variant=\"outlined\"\n            label=\"author\"\n            value={author}\n            onChange={(e) => onChangeAuthorName(e.target.value)}\n          />\n        </Grid>\n        <Grid item style={{ marginBottom: \"7vh\" }}>\n          <Button\n            aria-label=\"login\"\n            variant=\"contained\"\n            size=\"large\"\n            color=\"primary\"\n            onClick={onClick}\n          >\n            ADD BOOK\n          </Button>\n        </Grid>\n        <Grid>\n          <Snackbar\n            open={open}\n            message={message}\n            autoHideDuration={2000}\n            onClose={handleClose}\n          />\n        </Grid>\n      </Grid>\n      )}\n    </div>\n  );\n};\n"]},"metadata":{},"sourceType":"module"}